<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slice and Dice Pick Rate Analyzer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        h1 {
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .input-section {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: bold;
        }

        textarea {
            width: 100%;
            min-height: 150px;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            resize: vertical;
        }

        textarea:focus {
            outline: none;
            border-color: #4CAF50;
        }

        button {
            background-color: #4CAF50;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            width: 100%;
            margin-top: 10px;
        }

        button:hover {
            background-color: #45a049;
        }

        button:active {
            transform: translateY(1px);
        }

        .output-section {
            margin-top: 30px;
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 4px;
            border-left: 4px solid #4CAF50;
            display: none;
        }

        .output-section.visible {
            display: block;
        }

        .output-section h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 20px;
        }

        .output-section p {
            color: #555;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .hero-list {
            font-weight: bold;
            color: #4CAF50;
        }

        .error {
            color: #d32f2f;
            padding: 15px;
            background-color: #ffebee;
            border-radius: 4px;
            border-left: 4px solid #d32f2f;
            margin-top: 20px;
            display: none;
        }

        .error.visible {
            display: block;
        }

        .instructions {
            background-color: #e3f2fd;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            color: #1976d2;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé≤ Slice and Dice Pick Rate Analyzer</h1>
        
        <div class="instructions">
            <strong>Instructions:</strong> Paste your Slice and Dice pick rate JSON data below and click "Analyze" to see your most and least picked heroes.
            <br><br>
            <strong>Suffix Format:</strong> Each hero has unique suffixes pre-configured (e.g., Soldier ‚Üí soldier.n.SoldierTop / soldier.n.SoldierLow).
            <br>
            <em>Pick rates are normalized (+1 to both picked and not picked) to avoid 0% and 100% values.</em>
        </div>

        <div class="input-section">
            <label for="jsonInput">Paste JSON Data:</label>
            <textarea id="jsonInput" placeholder='{"pickRates":[{"n":"Berserker-hp","v":1245201},...]}'>{"pickRates":[{"n":"Berserker-hp","v":1245201},{"n":"Brute-hp","v":720926},{"n":"Collector-hp","v":1769483},{"n":"Gladiator-hp","v":851994},{"n":"Soldier-hp","v":1179681},{"n":"Whirl-hp","v":2555908},{"n":"Scrapper-hp","v":1048595},{"n":"Sinew-hp","v":1507343},{"n":"Barbarian-hp","v":1114127},{"n":"Brawler-hp","v":917524},{"n":"Curator-hp","v":720914},{"n":"Leader-hp","v":1703940},{"n":"Veteran-hp","v":1048593},{"n":"Bash-hp","v":1048583},{"n":"Eccentric-hp","v":1114116},{"n":"Captain-hp","v":1048579},{"n":"Wanderer-hp","v":196639},{"n":"Dabbler-hp","v":917523},{"n":"Gambler-hp","v":1507330},{"n":"Ranger-hp","v":851992},{"n":"Rogue-hp","v":786469},{"n":"Trapper-hp","v":1572871},{"n":"Spellblade-hp","v":983055},{"n":"Ninja-hp","v":2359302},{"n":"Juggler-hp","v":524318},{"n":"Ludus-hp","v":1507334},{"n":"Assassin-hp","v":393238},{"n":"Dancer-hp","v":1245200},{"n":"Fencer-hp","v":983057},{"n":"Sharpshot-hp","v":1900546},{"n":"Venom-hp","v":589841},{"n":"Roulette-hp","v":983047},{"n":"Dabblest-hp","v":1048580},{"n":"Agent-hp","v":327701},{"n":"Knight-hp","v":852009},{"n":"Armorer-hp","v":1769484},{"n":"Bard-hp","v":2097156},{"n":"Cleric-hp","v":1572880},{"n":"Guardian-hp","v":1835025},{"n":"Pilgrim-hp","v":1703953},{"n":"Monk-hp","v":786457},{"n":"Warden-hp","v":851995},{"n":"Keeper-hp","v":917525},{"n":"Paladin-hp","v":1245210},{"n":"Prince-hp","v":2031623},{"n":"Stalwart-hp","v":1179671},{"n":"Poet-hp","v":786451},{"n":"Valkyrie-hp","v":1966085},{"n":"Stoic-hp","v":1179671},{"n":"Druid-hp","v":1114145},{"n":"Herbalist-hp","v":327713},{"n":"Medic-hp","v":2555914},{"n":"Priestess-hp","v":2031635},{"n":"Vampire-hp","v":524325},{"n":"Enchanter-hp","v":2424837},{"n":"Disciple-hp","v":1638413},{"n":"Fey-hp","v":2424844},{"n":"Doctor-hp","v":1179666},{"n":"Forsaken-hp","v":2162692},{"n":"Prophet-hp","v":720922},{"n":"Shaman-hp","v":1179678},{"n":"Witch-hp","v":1835018},{"n":"Wraith-hp","v":2031621},{"n":"Surgeon-hp","v":917529},{"n":"Fate-hp","v":1179659},{"n":"Caldera-hp","v":786473},{"n":"Evoker-hp","v":2031626},{"n":"Glacia-hp","v":1769483},{"n":"Jester-hp","v":2293770},{"n":"Sparky-hp","v":1310751},{"n":"Myco-hp","v":1966089},{"n":"Seer-hp","v":1572885},{"n":"Fiend-hp","v":1376283},{"n":"Artificer-hp","v":1441798},{"n":"Weaver-hp","v":1179654},{"n":"Sorcerer-hp","v":262188},{"n":"Chronos-hp","v":1310733},{"n":"Warlock-hp","v":458768},{"n":"Ace-hp","v":1310726},{"n":"Ghast-hp","v":1900549},{"n":"Wizard-hp","v":524315},{"n":"Presence-hp","v":458757},{"n":"Spine-hp","v":327685},{"n":"Granite-hp","v":262148},{"n":"Statue-hp","v":327685},{"n":"Mimic-hp","v":589826},{"n":"Sphere-hp","v":393221},{"n":"Coffin-hp","v":196614},{"n":"Alien-hp","v":65547},{"n":"Tainted-hp","v":524290},{"n":"Luggage-hp","v":262149},{"n":"Vessel-hp","v":327683},{"n":"Jumble-hp","v":196615},{"n":"Dice-hp","v":262148},{"n":"Robot-hp","v":524288},{"n":"Twin-hp","v":196613}]}</textarea>
        </div>

        <button onclick="analyzeData()">Analyze Pick Rates</button>

        <div id="error" class="error"></div>
        <div id="output" class="output-section"></div>
    </div>

    <script src="hero_suffixes.js"></script>
    <script>
        const ORIGINAL_HEROPOOL = "Heropool.\nThief+scoundrel+lost+dabble+clumsy+fighter+brigand+lazy+hoarder+ruffian+defender+buckle+squire+alloy+wallop+healer+gardener+mystic+splint+acolyte+mage+prodigy+meddler+student+initiate+cultist+tinder+reflection+housecat+primrose+spade+pockets\n+dabbler+gambler+rogue+ranger+trapper+spellblade+ninja+juggler+berserker+brute+collector+gladiator+soldier+whirl+scrapper+sinew+knight+armorer+bard+cleric+guardian+pilgrim+monk+warden+druid+herbalist+medic+priestess+vampire+enchanter+disciple+fey+fiend+jester+sparky+caldera+evoker+glacia+myco+seer+presence+spine+granite+statue+mimic+sphere+coffin+alien\n+ludus+assassin+dancer+fencer+sharpshot+venom+roulette+dabblest+agent+barbarian+brawler+curator+leader+veteran+bash+eccentric+captain+wanderer+keeper+paladin+prince+stalwart+poet+valkyrie+stoic+doctor+forsaken+prophet+shaman+witch+wraith+surgeon+fate+warlock+ghast+artificer+weaver+sorcerer+chronos+ace+wizard+tainted+luggage+vessel+jumble+dice+robot+twin";
        
        function generateModifiedPool(topHeroes, bottomHeroes) {
            let modifiedPool = ORIGINAL_HEROPOOL;
            
            // Replace top picks with unique suffixes
            topHeroes.forEach(hero => {
                const heroName = hero.name;
                const heroLower = heroName.toLowerCase();
                const suffix = HERO_SUFFIXES[heroName]?.topPick || "TopPick";
                const pattern = new RegExp(`\\+${heroLower}\\+`, 'g');
                modifiedPool = modifiedPool.replace(pattern, `+${heroLower}.n.TopPick.${suffix}+`);
            });
            
            // Replace low picks with unique suffixes
            bottomHeroes.forEach(hero => {
                const heroName = hero.name;
                const heroLower = heroName.toLowerCase();
                const suffix = HERO_SUFFIXES[heroName]?.lowPick || "LowPick";
                const pattern = new RegExp(`\\+${heroLower}\\+`, 'g');
                modifiedPool = modifiedPool.replace(pattern, `+${heroLower}.n.LowPick.${suffix}+`);
            });
            
            return modifiedPool;
        }
        
        function analyzeData() {
            const input = document.getElementById('jsonInput').value.trim();
            const outputDiv = document.getElementById('output');
            const errorDiv = document.getElementById('error');
            
            // Hide previous results
            outputDiv.classList.remove('visible');
            errorDiv.classList.remove('visible');
            
            // Validate input
            if (!input) {
                showError('Please paste JSON data into the text area.');
                return;
            }
            
            try {
                // Parse JSON
                const data = JSON.parse(input);
                
                // Extract heroes only (items ending with -hp)
                if (!data.pickRates || !Array.isArray(data.pickRates)) {
                    showError('Invalid JSON format. Expected a "pickRates" array.');
                    return;
                }
                
                const heroes = data.pickRates
                    .filter(item => item.n && item.n.endsWith('-hp'))
                    .map(item => {
                        const v = item.v;
                        // Decode: lower 16 bits = times picked, upper bits = times not picked
                        const rawPicked = v & 0xFFFF;  // Lower 16 bits
                        const rawNotPicked = v >> 16;   // Upper bits
                        
                        // Adjust by adding +1 to both to normalize (avoid 0% and 100%)
                        const picked = rawPicked + 1;
                        const notPicked = rawNotPicked + 1;
                        const total = picked + notPicked;
                        const pickRate = (picked / total) * 100;
                        
                        return {
                            name: item.n.slice(0, -3), // Remove '-hp' suffix
                            picked: picked,
                            total: total,
                            pickRate: pickRate
                        };
                    })
                    .filter(hero => hero.total > 0); // Filter out heroes with no data
                
                if (heroes.length === 0) {
                    showError('No heroes found in the data. Make sure your JSON contains items with names ending in "-hp".');
                    return;
                }
                
                // Sort by number of times picked (highest to lowest)
                heroes.sort((a, b) => b.picked - a.picked);
                
                // Get top 3 and bottom 3
                const topHeroes = heroes.slice(0, 3);
                const bottomHeroes = heroes.slice(-3).reverse();
                
                // Display results
                displayResults(topHeroes, bottomHeroes);
                
            } catch (error) {
                showError('Invalid JSON format. Please check your data and try again. Error: ' + error.message);
            }
        }
        
        function displayResults(topHeroes, bottomHeroes) {
            const outputDiv = document.getElementById('output');
            
            const topNames = topHeroes.map(h => h.name).join(', ');
            const bottomNames = bottomHeroes.map(h => h.name).join(', ');
            
            const topDetails = topHeroes.map((h, i) => 
                `${i + 1}. ${h.name}: ${h.picked}/${h.total} picks (${h.pickRate.toFixed(1)}%)`
            ).join('<br>');
            
            const bottomDetails = bottomHeroes.map((h, i) => 
                `${i + 1}. ${h.name}: ${h.picked}/${h.total} picks (${h.pickRate.toFixed(1)}%)`
            ).join('<br>');
            
            // Generate modified hero pool
            const modifiedPool = generateModifiedPool(topHeroes, bottomHeroes);
            
            outputDiv.innerHTML = `
                <h2>üìä Analysis Results</h2>
                <p>Your <span class="hero-list">most picked heroes</span> are: <strong>${topNames}</strong></p>
                <p style="font-size: 14px; margin-left: 20px; color: #666;">${topDetails}</p>
                <br>
                <p>Your <span class="hero-list" style="color: #ff9800;">least picked heroes</span> are: <strong>${bottomNames}</strong></p>
                <p style="font-size: 14px; margin-left: 20px; color: #666;">${bottomDetails}</p>
                <br>
                <h2>üìù Modified Hero Pool</h2>
                <p style="font-size: 14px; color: #666; margin-bottom: 10px;">Copy the modified pool below (top 3 marked with .n.TopPick, bottom 3 marked with .n.LowPick):</p>
                <textarea id="modifiedPool" readonly style="width: 100%; min-height: 150px; padding: 10px; font-family: monospace; font-size: 12px; border: 2px solid #ddd; border-radius: 4px; background-color: #f9f9f9;">${modifiedPool}</textarea>
                <button onclick="copyToClipboard()" style="margin-top: 10px; padding: 8px 20px; background-color: #2196F3; width: auto;">Copy to Clipboard</button>
            `;
            
            outputDiv.classList.add('visible');
        }
        
        function copyToClipboard() {
            const textarea = document.getElementById('modifiedPool');
            textarea.select();
            document.execCommand('copy');
            
            // Visual feedback
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = '‚úì Copied!';
            button.style.backgroundColor = '#4CAF50';
            setTimeout(() => {
                button.textContent = originalText;
                button.style.backgroundColor = '#2196F3';
            }, 2000);
        }
        
        function showError(message) {
            const errorDiv = document.getElementById('error');
            errorDiv.textContent = '‚ùå Error: ' + message;
            errorDiv.classList.add('visible');
        }
    </script>
</body>
</html>